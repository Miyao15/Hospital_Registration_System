# 需求文档

## 简介

本功能实现医院门诊预约挂号系统的核心预约流程，允许患者选择科室、医生、日期和时间段进行预约挂号，支持号源实时显示和并发控制。

## 术语表

- **预约 (Appointment)**: 患者与医生之间的就诊预约记录
- **号源 (Slot)**: 医生在特定时间段可接诊的名额
- **排班 (Schedule)**: 医生的出诊时间安排
- **时间段 (TimeSlot)**: 就诊时间划分，如上午、下午、晚上

## 需求

### 需求 1

**用户故事:** 作为患者，我想查看医生的可预约日期，以便选择合适的就诊时间。

#### 验收标准

1. WHEN 患者选择某位医生 THEN 系统 SHALL 展示未来7-14天的可预约日期
2. WHEN 展示可预约日期 THEN 系统 SHALL 排除非工作日和医生休息日
3. WHEN 某日期号源已满 THEN 系统 SHALL 标记该日期为不可预约状态

### 需求 2

**用户故事:** 作为患者，我想查看某日期的可预约时间段和剩余号源，以便选择合适的时间。

#### 验收标准

1. WHEN 患者选择某个日期 THEN 系统 SHALL 展示该日期的时间段列表（上午/下午/晚上）
2. WHEN 展示时间段 THEN 系统 SHALL 实时显示每个时间段的剩余号源数量
3. WHEN 某时间段号源为0 THEN 系统 SHALL 禁用该时间段的选择

### 需求 3

**用户故事:** 作为患者，我想填写就诊信息并提交预约，以便完成挂号。

#### 验收标准

1. WHEN 患者提交预约 THEN 系统 SHALL 验证就诊人信息完整性
2. WHEN 患者提交预约 THEN 系统 SHALL 创建预约记录并设置状态为待就诊
3. WHEN 预约成功 THEN 系统 SHALL 扣减对应时间段的号源数量
4. WHEN 预约成功 THEN 系统 SHALL 生成唯一的预约单号

### 需求 4

**用户故事:** 作为患者，我想在预约时填写病情描述，以便医生提前了解情况。

#### 验收标准

1. WHEN 患者填写预约信息 THEN 系统 SHALL 提供病情描述输入框
2. WHEN 患者提交预约 THEN 系统 SHALL 保存病情描述到预约记录

### 需求 5

**用户故事:** 作为系统，我需要防止号源超额预约，以确保预约数量不超过限制。

#### 验收标准

1. WHEN 多个患者同时预约同一号源 THEN 系统 SHALL 使用并发控制防止超额
2. WHEN 号源已被其他患者抢占 THEN 系统 SHALL 返回预约失败提示
3. WHEN 预约失败 THEN 系统 SHALL 不扣减号源数量

### 需求 6

**用户故事:** 作为患者，我想查看预约成功的详细信息，以便准备就诊。

#### 验收标准

1. WHEN 预约成功 THEN 系统 SHALL 展示预约单号、医生信息、就诊时间
2. WHEN 预约成功 THEN 系统 SHALL 展示科室位置和注意事项
